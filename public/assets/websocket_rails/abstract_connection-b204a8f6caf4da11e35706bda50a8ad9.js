(function(){WebSocketRails.AbstractConnection=function(){function t(t,e){this.dispatcher=e,this.message_queue=[]}return t.prototype.close=function(){},t.prototype.trigger=function(t){return"connected"!==this.dispatcher.state?this.message_queue.push(t):this.send_event(t)},t.prototype.send_event=function(t){return null!=this.connection_id?t.connection_id=this.connection_id:void 0},t.prototype.on_close=function(t){var e;return this.dispatcher&&this.dispatcher._conn===this?(e=new WebSocketRails.Event(["connection_closed",t]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(e)):void 0},t.prototype.on_error=function(t){var e;return this.dispatcher&&this.dispatcher._conn===this?(e=new WebSocketRails.Event(["connection_error",t]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(e)):void 0},t.prototype.on_message=function(t){return this.dispatcher&&this.dispatcher._conn===this?this.dispatcher.new_message(t):void 0},t.prototype.setConnectionId=function(t){this.connection_id=t},t.prototype.flush_queue=function(){var t,e,n,i;for(i=this.message_queue,e=0,n=i.length;n>e;e++)t=i[e],this.trigger(t);return this.message_queue=[]},t}()}).call(this);